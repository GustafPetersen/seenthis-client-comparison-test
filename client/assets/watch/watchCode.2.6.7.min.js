function OTW(t){var e=this,i=t;this.getInformations=function(){for(var t=0,e=0,i=0,a=0,s=0;s<this.hands.length;s++){var o=0;this.hands[s].effectTypes&&(o=this.hands[s].effectTypes.length),true==this.hands[s].isMagnified&&true==this.hands[s].duplicateUnderCyclop?(t++,i+=o):(e++,a+=o)}var n=t+e-this.staticContent.length+(i+a)+t+i,h="";return h+="\nCode version: 2.6.7",h+="\nCanvas dimensions: "+this.globalWatch_width+"px width by "+this.globalWatch_height+"px height",h+="\nRotated elements ("+n+"): "+(t+e-this.staticContent.length)+" + "+(i+a)+" effects, including "+this.optionalItems.length+" optional elements or effects",true==this.hasCyclop&&(h+=" (+ "+t+" for the cyclop + "+i+" effects, including "+this.optionalItemsUnderCyclop.length+" optional elements or effects)"),h+="\nStatic elements ("+this.staticContentFileName.length+"): "+JSON.stringify(this.staticContentFileName),h+="\nDynamic elements ("+this.dynamicContentImageNameFormat.length+"): "+JSON.stringify(this.dynamicContentImageNameFormat),h+="\nperformanceSamplingHistory: \n"+JSON.stringify(this.performanceSamplingHistory).split(",").join("\n"),h=(h+="\n").replace(/"/g,"'")},this.getDrawSnapShot=function(){this.isGettingDrawSnapShot=true,this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(this.defaultPositionDate,null,"backupRotation"),this.isGettingDrawSnapShot=false},this.getImageURLs=function(){return Object.keys(this.imageURLs).sort()},this.runWatchOvertime=function(){true==this.hasOptionalElement&&(this.performanceLast10=[],this.performanceTreshold=1e3/this.globalWatch_ticksPerSecond,this.shouldTestPerformance=true),this.watchIsShownOnStaticDefaultTimeAndDate=false,this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(null,null,null),clearInterval(this.globalWatch_timer),this.globalWatch_timer=setInterval(function(){e.updateWatchTimeFromTimer()},1e3/this.globalWatch_ticksPerSecond),this.globalWatch_isRunning=true,this.globalWatch_hasBeenPaused=false},this.pauseWatchRun=function(){this.globalWatch_spinTimers.length>0&&this.globalWatch_spinTimers[0]&&(clearInterval(this.globalWatch_spinTimers[0]),this.globalWatch_spinTimers.splice(0,1)),true==this.globalWatch_isRunning&&(this.handsBackupDate=new Date,this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(null,null,"backupRotation"),clearInterval(this.globalWatch_timer),this.globalWatch_isRunning=false,this.globalWatch_hasBeenPaused=true)},this.unPauseWatchRun=function(){if(false==this.globalWatch_isRunning){this.isUnpausingWatchRun=true,true==this.chronoIsRunning&&(this.chronoTotalRunTime+=this.globalWatch_spinTime),true==this.countdownIsRunning&&(this.countdownTotalRunTime+=this.globalWatch_spinTime);var t=this.getDateForGivenTimezone("");t.setSeconds(t.getSeconds()+this.globalWatch_spinTime/1e3),this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(t,null,"targetRotation"),true==this.chronoIsRunning&&(this.chronoTotalRunTime-=this.globalWatch_spinTime),true==this.countdownIsRunning&&(this.countdownTotalRunTime-=this.globalWatch_spinTime),this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(null,"backupRotation",null),true==this.hasOptionalElement&&(this.performanceLast10=[],this.performanceTreshold=this.globalWatch_delayBetweenSpinSteps,this.shouldTestPerformance=true),this.spinHandsFromCurrentPositionToTargetPositionWithDelay(0)}},this.setHandsToDefaultPosition=function(){this.shouldTestPerformance=false,this.chronoTotalRunTime=this.defaultPositionChronoTotalRunTime,this.countdownTotalRunTime=this.defaultPositionCountDownTotalRunTime,this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(this.defaultPositionDate,null,"backupRotation")},this.setDateShouldUpdateBeforeSpinTo=function(t){this.dynamicElementsCanUpdateDuringSpin=t},this.setHoursOffset=function(t){this.hoursOffset=t},this.setMinutesOffset=function(t){this.minutesOffset=t},this.setSecondsOffset=function(t){this.secondsOffset=t},this.addHoursOffset=function(t){this.setHoursOffset(this.hoursOffset+t)},this.addMinutesOffset=function(t){this.setMinutesOffset(this.minutesOffset+t)},this.addSecondsOffset=function(t){this.setSecondsOffset(this.secondsOffset+t)},this.showAndRun=function(t){var e="defaultTime";null!==t.startOption&&void 0!==t.startOption&&(e=t.startOption);var i=0;if(null!==t.techElapsedTime&&void 0!==t.techElapsedTime&&(i=t.techElapsedTime),t.targetDivName?document.getElementById(t.targetDivName).appendChild(this.globalWatch):t.targetElement?t.targetElement.appendChild(this.globalWatch):console.log("error from showAndRun : no target to add the watch to"),this.handsCount=this.hands.length,this.watchIsShownOnStaticDefaultTimeAndDate=false,true==this.hasChronoCapabilities?this.chronoTotalRunTime=i:true==this.hasCountdownCapabilities&&(this.countdownTotalRunTime=i),"spinToTime"==e){if(i>0){var a=this.globalWatch_spinTime+this.globalWatch_delayBeforeSpin;true==this.hasChronoCapabilities?this.chronoTotalRunTime+=a:true==this.hasCountdownCapabilities&&(this.countdownTotalRunTime+=a)}this.spinToTimeWithTechElapsedTime(i)}else"defaultTime"==e?(this.watchIsShownOnStaticDefaultTimeAndDate=true,this.changeStateImagesButtonFrom_to("disabled","normal"),this.setHandsToDefaultPosition()):"debugHandRotation"==e?(this.changeStateImagesButtonFrom_to("disabled","normal"),this.debugHandRotationOvertime()):(this.changeStateImagesButtonFrom_to("disabled","normal"),this.runWatchOvertime())},this.spinToDefaultPosition=function(){if(false==this.watchIsShownOnStaticDefaultTimeAndDate){var t=true;false==this.globalWatch_isRunning&&(t=false),this.pauseWatchRun(),this.shouldTakeSpinTimeDelayIntoAccount=false,this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(this.defaultPositionDate,null,"targetRotation"),true==t?this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(null,null,null):this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(null,"backupRotation",null),true==this.hasOptionalElement&&(this.performanceLast10=[],this.performanceTreshold=this.globalWatch_delayBetweenSpinSteps,this.shouldTestPerformance=true),this.spinHandsFromCurrentPositionToTargetPositionWithDelay(0),setTimeout(function(){e.pauseWatchRun(),e.setHandsToDefaultPosition(),e.watchIsShownOnStaticDefaultTimeAndDate=true},e.globalWatch_spinTime)}},this.spinToTimeWithTechElapsedTime=function(t){var e;this.shouldTakeSpinTimeDelayIntoAccount=true,e=t>0?this.globalWatch_spinTime+this.globalWatch_delayBeforeSpin:0,this.chronoTotalRunTime=this.chronoTotalRunTimeWanted,this.countdownTotalRunTime=this.countdownTotalRunTimeWanted,this.shouldTakeSpinTimeDelayIntoAccount=true,this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(null,null,"targetRotation"),this.shouldTakeSpinTimeDelayIntoAccount=false,this.watchIsShownOnStaticDefaultTimeAndDate=true,this.setHandsToDefaultPosition(),true==this.hasChronoCapabilities?this.chronoTotalRunTimeWanted=this.chronoTotalRunTimeWanted+t+e:true==this.hasCountdownCapabilities&&(this.countdownTotalRunTimeWanted=this.countdownTotalRunTimeWanted+t+e),true==this.hasOptionalElement&&(this.performanceLast10=[],this.performanceTreshold=this.globalWatch_delayBetweenSpinSteps,this.shouldTestPerformance=true),this.spinHandsFromCurrentPositionToTargetPositionWithDelay(this.globalWatch_delayBeforeSpin)},this.spinToTimeWithTechElapsedTimeAndStartCapabilityAfterDelay=function(t,e){this.spinToTimeWithTechElapsedTime(t),this.shouldAutostartCapability=true,this.autostartCapabilityDelay=e},this.spinHandsFromCurrentPositionToTargetPositionWithDelay=function(t){if(this.isSpining=true,this.globalWatch_totalSpinDone>0){clearInterval(this.globalWatch_spinTimers[0]),this.globalWatch_spinTimers.splice(0,1),this.globalWatch_totalSpinDone=0;for(var i=0;i<this.handsCount;i++){null!=this.hands[i].cycleTime&&(this.hands[i].currentRotation=this.hands[i].currentSpinRotation)}}this.globalWatch_totalSpinSteps=1/this.globalWatch_delayBetweenSpinSteps*this.globalWatch_spinTime,setTimeout(function(){if(true==e.canvasIsAvailable()){var t=setInterval(function(){e.spinHandsFromCurrentPositionToTargetPositionFromTimer()},e.globalWatch_delayBetweenSpinSteps);e.globalWatch_spinTimers.push(t)}},t)},this.spinHandsFromCurrentPositionToTargetPositionFromTimer=function(){if(true==e.canvasIsAvailable()){for(var t=0;t<this.handsCount;t++){var i=this.hands[t];if(null!=i.cycleTime&&("timezoneChange"==this.globalWatch_spinType&&(("hours"==i.cycleType||"minutes"==i.cycleType)&&24!=i.cycleTime||(i=null)),null!=i)){for(var a=i.currentRotation,s=i.targetRotation;s<a;)s+=360;true==i.cycleIsReversed&&s>a&&(s-=360);var o=this.easeInOutQuadWithT_withB_withC_withD(this.globalWatch_totalSpinDone,a,s-a,this.globalWatch_totalSpinSteps);i.currentSpinRotation=o}}this.shouldSaveUpdatedRotations=false,this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(null,"currentSpinRotation",null),this.globalWatch_totalSpinDone++}else this.globalWatch_totalSpinDone=this.globalWatch_totalSpinSteps;this.globalWatch_totalSpinDone>=this.globalWatch_totalSpinSteps&&(clearInterval(this.globalWatch_spinTimers[0]),this.globalWatch_spinTimers.splice(0,1),this.globalWatch_totalSpinDone=0,this.chronoTotalRunTime=this.chronoTotalRunTimeWanted,this.countdownTotalRunTime=this.countdownTotalRunTimeWanted,this.runWatchOvertime(),this.globalWatch_spinType=null,this.isSpining=false,this.isUnpausingWatchRun=false,true==this.chronoShouldRunAfterSpin&&(this.chronoShouldRunAfterSpin=false),this.shouldSaveUpdatedRotations=true,true==this.shouldAutostartCapability&&(this.shouldAutostartCapability=false,setTimeout(function(){true==e.hasChronoCapabilities?e.startChronoMovement():true==e.hasCountdownCapabilities&&e.startCountdownMovement()},e.autostartCapabilityDelay)))},this.addTimepieceCenter=function(t){t.name&&t.xPos&&t.yPos||console.log("error from addTimepieceCenter");var e=new OTWTimepieceCenter;e.createNewTimepieceCenterNamed_xCenter_yCenter(t.name,t.xPos,t.yPos),this.timepieceCenters.push(e)},this.addTimepieceUnderCyclop=function(t){t.fileName||console.log("error from addTimepieceUnderCyclop");var a=0;null!==t.cyclopXPos&&void 0!==t.cyclopXPos&&(a=t.cyclopXPos);var s=0;null!==t.cyclopYPos&&void 0!==t.cyclopYPos&&(s=t.cyclopYPos);var o=0;null!==t.timepieceXOffset&&void 0!==t.timepieceXOffset&&(o=t.timepieceXOffset);var n=0;null!==t.timepieceYOffset&&void 0!==t.timepieceYOffset&&(n=t.timepieceYOffset);var h=1;null!==t.zoomValue&&void 0!==t.zoomValue&&(h=t.zoomValue),this.hasCyclop=true,this.globalWatch_magnifiedValue=h,this.globalWatch_magnifiedOffsetX=o,this.globalWatch_magnifiedOffsetY=n,this.globalWatch_cyclopMaskImage=new Image,this.globalWatch_cyclopMaskImage.src=this.globalWatch_imageFolderName+"/"+t.fileName,this.globalWatch_cyclopPosX=a,this.globalWatch_cyclopPosY=s;var l=document.createElement("DIV");l.setAttribute("id","OTW_magnifiedTimepieceHolder_"+i),l.setAttribute("width",this.globalWatch_width),l.setAttribute("height",this.globalWatch_height),l.style.left="0px",l.style.top="0px",l.style.position="absolute",this.timepieceHolders.push(l),this.globalWatch.appendChild(l);var r=document.createElement("CANVAS");r.setAttribute("id","OTW_magnifiedTimepiece_"+i),r.setAttribute("width",this.globalWatch_width),r.setAttribute("height",this.globalWatch_height),r.style.left="0px",r.style.top="0px",r.style.position="absolute",this.timepieces.push(r),l.appendChild(r);var c=document.createElement("DIV");c.setAttribute("id","OTW_cyclop_"+i),c.style.left=a+"px",c.style.top=s+"px",this.globalWatch.appendChild(c);var d=new Image;d.onload=function(){e.imagesToBeLoaded.splice(e.imagesToBeLoaded.indexOf(d.src),1),c.setAttribute("width",d.width),c.setAttribute("height",d.height),c.style.width=d.width+"px",c.style.height=d.height+"px",c.style.backgroundImage="url("+d.src+")",c.style.position="absolute"},d.src=this.globalWatch_imageFolderName+"/"+t.fileName,this.imagesToBeLoaded.push(d.src),this.imageURLs[d.src]=true,this.globalWatch_cyclopMaskImage=new Image,this.globalWatch_cyclopMaskImage.onload=function(){e.imagesToBeLoaded.splice(e.imagesToBeLoaded.indexOf(e.globalWatch_cyclopMaskImage.src),1)},this.globalWatch_cyclopMaskImage.src=this.globalWatch_imageFolderName+"/"+t.fileName.split(".png")[0]+"_mask.png",this.imagesToBeLoaded.push(this.globalWatch_cyclopMaskImage.src),this.imageURLs[this.globalWatch_cyclopMaskImage.src]=true},this.createNewWatch=function(t){t.imageFolder&&t.timePieceXCenter&&t.timePieceYCenter||console.log("error from createNewWatch");var a=null;null!==t.backgroundFileName&&void 0!==t.backgroundFileName&&(a=t.backgroundFileName);var s=null;null!==t.width&&void 0!==t.width&&(s=t.width);var o=null;null!==t.height&&void 0!==t.height&&(o=t.height);var n=0;for(null!==t.baseRotation&&void 0!==t.baseRotation&&(n=t.baseRotation);n<0;)n+=360;var h=100;null!==t.xScale&&void 0!==t.xScale&&(h=t.xScale);var l=100;null!==t.yScale&&void 0!==t.yScale&&(l=t.yScale);var r=0;null!==t.xSkew&&void 0!==t.xSkew&&(r=t.xSkew);var c=0;null!==t.ySkew&&void 0!==t.ySkew&&(c=t.ySkew);var d=0;for(null!==t.lightSource&&void 0!==t.lightSource&&(d=t.lightSource);d<0;)d+=360;if(this.globalWatch_timeCoef=1,this.globalWatch_ticksPerSecond=8,this.globalWatch_hasBeenPaused=false,this.globalWatch_countdownZeroAngle=120,this.globalWatch_baseRotationAngle=n,this.globalWatch_baseScaleX=h/100,this.globalWatch_baseScaleY=l/100,this.globalWatch_baseSkewX=r,this.globalWatch_baseSkewY=c,this.globalWatch_lightSourceAngle=d,this.globalWatch_xCenter=t.timePieceXCenter,this.globalWatch_yCenter=t.timePieceYCenter,this.hasCyclop=false,this.hasCountdownCapabilities=false,this.hasChronoCapabilities=false,this.hasAlarmCapabilities=false,this.globalWatch_spinTime=2e3,this.globalWatch_totalSpinDone=0,this.globalWatch_delayBeforeSpin=2e3,this.globalWatch_delayBetweenSpinSteps=30,this.globalWatch_imageFolderName=t.imageFolder,this.globalWatch_backgroundImageName=a,this.shouldAutostartCapability=false,this.autostartCapabilityDelay=0,this.performanceLast10=[],this.isInLowPerfMode=false,this.performanceTreshold=this.globalWatch_delayBetweenSpinSteps,this.shouldTestPerformance=false,this.hasOptionalElement=false,this.lastSmallestSuccessfulTreshold=1e5,this.performanceSamplingHistory=[],this.optionalItems=[],this.optionalItemsUnderCyclop=[],this.dynamicElementsCanUpdateDuringSpin=false,this.isSpining=false,this.isUnpausingWatchRun=false,this.allWeekDayImagesAlreadyLoaded=[],this.allMonthDateImagesAlreadyLoaded=[],this.allYearMonthImagesAlreadyLoaded=[],this.hoursOffset=0,this.minutesOffset=0,this.secondsOffset=0,this.chronoTotalRunTime=0,this.chronoTotalRunTimeWanted=0,this.countdownInitialValue=600,this.countdownTotalRunTime=0,this.countdownTotalRunTimeWanted=60,this.alarmIsOn=true,this.defaultPositionDate=new Date(2006,7,28,10,11,31),this.defaultPositionChronoTotalRunTime=32814,this.defaultPositionCountDownTotalRunTime=27,this.imagesToBeLoaded=new Array,this.imageURLs={},this.createAdditionalVars(),a){var u=document.createElement("DIV");u.setAttribute("id","OTW_backgroundImageView_"+i),u.style.left="0px",u.style.top="0px",u.style.position="absolute"}this.globalWatch=document.createElement("DIV"),this.globalWatch.setAttribute("id","OTW_globalWatch_"+i),this.globalWatch.style.position="relative",a&&this.globalWatch.appendChild(u);var m=document.createElement("DIV");m.setAttribute("id","OTW_mainTimepieceHolder_"+i),m.style.left="0px",m.style.top="0px",m.style.position="absolute",this.timepieceHolders=new Array(m),this.globalWatch.appendChild(m);var _=document.createElement("CANVAS");function g(t,i){a&&e.imagesToBeLoaded.splice(e.imagesToBeLoaded.indexOf(f.src),1),e.globalWatch_width=t,e.globalWatch_height=i,e.globalWatch.style.width=t+"px",e.globalWatch.style.height=i+"px",a&&(u.style.width=t+"px",u.style.height=i+"px",u.style.backgroundImage="url("+f.src+")");for(var s=0;s<e.timepieces.length;s++)e.timepieces[s].setAttribute("width",t),e.timepieces[s].setAttribute("height",i),e.timepieces[s].style.width=t+"px",e.timepieces[s].style.height=i+"px",e.timepieceHolders[s].setAttribute("width",t),e.timepieceHolders[s].setAttribute("height",i),e.timepieceHolders[s].style.width=t+"px",e.timepieceHolders[s].style.height=i+"px"}if(_.setAttribute("id","OTW_mainTimepiece_"+i),_.style.left="0px",_.style.top="0px",_.style.position="absolute",this.timepieces=new Array(_),m.appendChild(_),this.globalWatch_spinTimers=new Array,this.hands=new Array,this.dynamicContent=new Array,this.dynamicContentImageNameFormat=new Array,this.dynamicContentType=new Array,this.dynamicContentPosX=new Array,this.dynamicContentPosY=new Array,this.dynamicContentTimezone=new Array,this.staticContent=new Array,this.staticContentFileName=new Array,this.staticContentPosX=new Array,this.staticContentPosY=new Array,this.staticContentAlpha=new Array,this.timepieceCenters=new Array,this.buttons=new Array,this.timezones=new Object,this.tmpCanvas=document.createElement("canvas"),a){var f=new Image;f.onload=function(){g(f.width,f.height)},f.src=this.globalWatch_imageFolderName+"/"+a,this.imagesToBeLoaded.push(f.src),this.imageURLs[f.src]=true}else g(s,o);this.isGettingDrawSnapShot=false},this.addDynamicContent=function(t){t.fileNameFormat&&t.contentType||console.log("error from addDynamicContent");var e=0;null!==t.xPos&&void 0!==t.xPos&&(e=t.xPos);var i=0;null!==t.yPos&&void 0!==t.yPos&&(i=t.yPos);var a=null;null!==t.timezone&&void 0!==t.timezone&&(a=t.timezone),null!=a&&""!=a||(a="deviceTime");var s=new OTWTimezone;s.createNewTimeZoneWithName(a),this.timezones[a]=s,"monthdate"==t.contentType||("weekday"==t.contentType||t.contentType);for(var o=0;o<this.timepieceHolders.length;o++){this.dynamicContent.push(o),this.dynamicContentPosX.push(e),this.dynamicContentPosY.push(i),this.dynamicContentImageNameFormat.push(t.fileNameFormat),this.dynamicContentType.push(t.contentType);var n=window.location.href,h=n.substring(0,n.lastIndexOf("/")+1),l=t.fileNameFormat.split("[x]")[0],r=t.fileNameFormat.split("[x]")[1];if("monthdate"==t.contentType)for(o=1;o<=31;o++){var c=h+this.globalWatch_imageFolderName+"/"+l+o+r;this.imageURLs[c]=true}if("weekday"==t.contentType)for(o=1;o<=7;o++){c=h+this.globalWatch_imageFolderName+"/"+l+o+r;this.imageURLs[c]=true}if("yearmonth"==t.contentType)for(o=1;o<=12;o++){c=h+this.globalWatch_imageFolderName+"/"+l+o+r;this.imageURLs[c]=true}this.dynamicContentTimezone.push(a)}},this.addRotatedContent=function(t){t.fileName&&t.cycleType&&t.cycleTime||console.log("error from addRotatedContent");var e=null;null!==t.centerName&&void 0!==t.centerName&&(e=t.centerName);var i=null;null!==t.maskName&&void 0!==t.maskName&&(i=t.maskName);var a="drawOverOpaque";null!==t.maskMode&&void 0!==t.maskMode&&(a=t.maskMode);var s=0;null!==t.xCenter&&void 0!==t.xCenter&&(s=t.xCenter);var o=0;null!==t.yCenter&&void 0!==t.yCenter&&(o=t.yCenter);var n=0;null!==t.xOffset&&void 0!==t.xOffset&&(n=t.xOffset);var h=0;null!==t.yOffset&&void 0!==t.yOffset&&(h=t.yOffset);var l=false;null!==t.cycleIsReversed&&void 0!==t.cycleIsReversed&&(l=t.cycleIsReversed);var r=true;null!==t.cycleIsSmooth&&void 0!==t.cycleIsSmooth&&(r=t.cycleIsSmooth);var c=true;null!==t.duplicateUnderCyclop&&void 0!==t.duplicateUnderCyclop&&(c=t.duplicateUnderCyclop);var d=null;null!==t.timezone&&void 0!==t.timezone&&(d=t.timezone);var u=null;null!==t.lightEffects&&void 0!==t.lightEffects&&(u=t.lightEffects);var m=false;null!==t.isOptional&&void 0!==t.isOptional&&true==(m=t.isOptional)&&(this.hasOptionalElement=true),null!=d&&""!=d||(d="deviceTime");var _=new OTWTimezone;_.createNewTimeZoneWithName(d),this.timezones[d]=_,t.cycleType.indexOf("countdown")>-1?this.hasCountdownCapabilities=true:t.cycleType.indexOf("chrono")>-1?this.hasChronoCapabilities=true:t.cycleType.indexOf("alarm")>-1&&(this.hasAlarmCapabilities=true);for(var g=0;g<this.timepieces.length;g++){var f=this.globalWatch_xCenter,p=this.globalWatch_yCenter,T=this.getX_withRotatedCoordinateSystemTo_withY(n,this.globalWatch_baseRotationAngle,h)+f,b=this.getY_withRotatedCoordinateSystemTo_withX(h,this.globalWatch_baseRotationAngle,n)+p;if(T=n,b=h,e)for(var y=0;y<this.timepieceCenters.length;y++)if(this.timepieceCenters[y].name==e){T+=this.timepieceCenters[y].xCenter-this.globalWatch_xCenter,b+=this.timepieceCenters[y].yCenter-this.globalWatch_yCenter;break}var w=new OTWHand;if(w.createNewHandWithTarget_imageNamed_toCenter_xCenter_yCenter_xOffset_yOffset_cycleType_cycleTime_cycleIsReversed_cycleIsSmooth_timezone_lightEffects_maskName_maskMode_duplicateUnderCyclop_isOptional(this,t.fileName,e,s,o,T,b,t.cycleType,t.cycleTime,l,r,d,u,i,a,c,m),w.isMagnified=0!=g,true==m)if(true==w.isMagnified){if(this.optionalItemsUnderCyclop.push(t.fileName),u)for(y=0;y<u.length;y++)this.optionalItemsUnderCyclop.push("-"+t.cycleType+"/"+y+"/"+u[y])}else if(this.optionalItems.push(t.fileName),u)for(y=0;y<u.length;y++)this.optionalItems.push("-"+t.cycleType+"/"+y+"/"+u[y]);g==this.timepieces.length-1&&this.hands.push(w)}},this.addStaticContent=function(t){t.fileName||console.log("error from addStaticContent");var i=0;null!==t.xPos&&void 0!==t.xPos&&(i=t.xPos);var a=0;null!==t.yPos&&void 0!==t.yPos&&(a=t.yPos);var s=100;null!==t.alpha&&void 0!==t.alpha&&(s=t.alpha);var o=new Image;o.onload=function(){e.imagesToBeLoaded.splice(e.imagesToBeLoaded.indexOf(o.src),1)},o.src=this.globalWatch_imageFolderName+"/"+t.fileName,this.imagesToBeLoaded.push(o.src),this.imageURLs[o.src]=true,this.staticContent.push(o),this.staticContentFileName.push(t.fileName),this.staticContentPosX.push(i),this.staticContentPosY.push(a),this.staticContentAlpha.push(s),this.hands.push(this.staticContent.length-1)},this.getDateForGivenTimezone=function(t){var e;if("utc"==t){var i=new Date;e=new Date(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds())}else""!=t&&"deviceTime"!=t||(e=new Date);return e.setHours(e.getHours()+this.hoursOffset),e.setMinutes(e.getMinutes()+this.minutesOffset),e.setSeconds(e.getSeconds()+this.secondsOffset),e},this.updateWatchTimeFromTimer=function(){true==this.canvasIsAvailable()?this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(null,null,null):this.globalWatch_timer&&clearInterval(this.globalWatch_timer)},this.drawTimepiece=function(t,e,i,a){var s=false;if(true==this.isGettingDrawSnapShot){console.log("---------------------------------------------------------------------------");var o="";true==e&&(o="magnified "),console.log('this.drawTimepiece with magnify = "'+e+'" the_optionalRotations = "'+i+'" the_saveRotationsTo = "'+a+'"')}for(var n=0;n<this.handsCount;n++){var h=this.hands[n],l=true;if(true==this.isInLowPerfMode&&true==h.isOptional&&(l=false),false==h.duplicateUnderCyclop&&true==e&&(l=false),true==l){if(t.save(),true==h.isOptional&&true==this.shouldTestPerformance&&(t.globalAlpha=.01),null==h.cycleTime)this.staticContent[h].width>0&&false==e&&(true==this.isGettingDrawSnapShot&&console.log("drawing "+o+'static "'+this.staticContentFileName[h]+'"'),t.drawImage(this.staticContent[h],this.staticContentPosX[h]-this.globalWatch_xCenter,this.staticContentPosY[h]-this.globalWatch_yCenter,this.staticContent[h].width,this.staticContent[h].height));else if(false==h.isMagnified&&true==e);else{var r=false;"timezoneChange"==this.globalWatch_spinType&&(true,24!=h.cycleTime&&("hours"!=h.cycleType&&"minutes"!=h.cycleType||(r=true)));var c=0,d=h.cycleType,u=h.cycleTime,m=h.cycleIsReversed,_=h.cycleIsSmooth,g=h.timezone;null!=g&&""!=g||(g="deviceTime");var f=(D=this.timezones[g]).millisecond,p=D.second,T=D.minute,b=D.hour;this.getDateForGivenTimezone(g);if("hours"==d)c+=b*(360/u),true==_&&(c+=T*(360/u/60)),this.currentHours=b,1!=this.globalWatch_timeCoef&&(c+=p*(360/u),true==_&&(c+=f*(360/u/1e3)),c=c*this.globalWatch_timeCoef*.3,c%=360);else if("minutes"==d)c+=T*(360/u),true==_&&(c+=p*(360/u/60)),this.currentMinutes=T,1!=this.globalWatch_timeCoef&&(c+=p*(360/u),true==_&&(c+=f*(360/u/1e3)),c=c*this.globalWatch_timeCoef*.6,c%=360);else if("seconds"==d)c+=p*(360/u),true==_&&(c+=f*(360/u/1e3)),this.currentSeconds=p,1!=this.globalWatch_timeCoef&&(c+=p*(360/u),true==_&&(c+=f*(360/u/1e3)),c*=this.globalWatch_timeCoef,c%=360);else if("days"==d){c+=(A=D.monthDate)*(360/u),true==_&&(c+=b*(360/u/24)),this.currentDays,this.currentDays=A}else if("moons"==d)c+=this.radiansToDegrees(this.moonPhaseForDate(D.getDate()));else if(true==this.hasChronoCapabilities){var y=0;if(null!=this.chronoTimestampOnStart)y=((new Date).getTime()-this.chronoTimestampOnStart.getTime())/1e3+this.chronoTotalRunTime;true!=this.chronoIsRunning&&(y=this.chronoTotalRunTime),this.chronoTotalAccumulatedTime=y,"chrono_seconds"==d?c+=true==_?y*(360/u):Math.floor(y)*(360/u):"chrono_minutes"==d?(y/=60,c+=true==_?y*(360/u):Math.floor(y)*(360/u)):"chrono_hours"==d&&(y/=3600,c+=true==_?y*(360/u):Math.floor(y)*(360/u))}else if(true==this.hasCountdownCapabilities){var w,W=0;if(null!=this.countdownTimestampOnStart)w=((new Date).getTime()-this.countdownTimestampOnStart.getTime())/1e3,W=this.countdownTotalRunTime;true!=this.countdownIsRunning?W=this.countdownTotalRunTime:this.countdownTotalRunTime=w,"countdown_minutes"==d?true!=this.countdownHasReachedEnd?(W/=60,c+=true==_?W*(360/u):Math.floor(W)*(360/u),rotationOffset=this.globalWatch_countdownZeroAngle-this.countdownInitialValue/60*(360/u),minimumValue=this.globalWatch_countdownZeroAngle-360/u*10,(c+=rotationOffset)>0&&c>this.globalWatch_countdownZeroAngle?(c=this.globalWatch_countdownZeroAngle,this.onCountdownReachedEnd()):c<0&&c<minimumValue&&(c=minimumValue)):c=this.globalWatch_countdownZeroAngle:"countdown_seconds"==d&&(c+=true==_?W*(360/u):Math.floor(W)*(360/u))}else this.traceGivenLog("Unrecognized CycleType received: "+d);for(true==m&&(c=-c),c+=this.globalWatch_baseRotationAngle;c>360;)c-=360;for(;c<0;)c+=360;if("targetRotation"==i?c=h.targetRotation:"backupRotation"==i?c=h.backupRotation:"currentSpinRotation"==i&&(c=h.currentSpinRotation),true!=r&&false!=this.shouldSaveUpdatedRotations&&(h.currentRotation=c),"targetRotation"==a?h.targetRotation=c:"backupRotation"==a&&(h.backupRotation=c),false==s&&true!=this.doIdleDynamicElements){s=true;var v=t.globalAlpha;t.globalAlpha=1;for(var C=0;C<this.dynamicContent.length;C++){var R=this.dynamicContentType[C],S=this.dynamicContentImageNameFormat[C],I=this.dynamicContentTimezone[C],x=this.dynamicContentPosX[C],O=this.dynamicContentPosY[C],D=this.timezones[I];if(contentImage=new Image,"monthdate"==R){var A=D.monthDate;false==this.dynamicElementsCanUpdateDuringSpin&&true==this.isSpining&&false==this.isUnpausingWatchRun&&(A=this.defaultPositionDate.getDate()),this.allMonthDateImagesAlreadyLoaded[A]?contentImage=this.allMonthDateImagesAlreadyLoaded[A]:(contentImage.src=this.globalWatch_imageFolderName+"/"+S.split("[x]")[0]+A+S.split("[x]")[1],this.allMonthDateImagesAlreadyLoaded[A]=contentImage)}else if("weekday"==R){var M=D.weekDay+1;false==this.dynamicElementsCanUpdateDuringSpin&&true==this.isSpining&&false==this.isUnpausingWatchRun&&(M=this.defaultPositionDate.getDay()+1),this.allWeekDayImagesAlreadyLoaded[M]?contentImage=this.allWeekDayImagesAlreadyLoaded[M]:(contentImage.src=this.globalWatch_imageFolderName+"/"+S.split("[x]")[0]+M+S.split("[x]")[1],this.allWeekDayImagesAlreadyLoaded[M]=contentImage)}else if("yearmonth"==R){var k=D.yearMonth+1;false==this.dynamicElementsCanUpdateDuringSpin&&true==this.isSpining&&false==this.isUnpausingWatchRun&&(k=this.defaultPositionDate.getMonth()+1),this.allYearMonthImagesAlreadyLoaded[k]?contentImage=this.allYearMonthImagesAlreadyLoaded[k]:(contentImage.src=this.globalWatch_imageFolderName+"/"+S.split("[x]")[0]+k+S.split("[x]")[1],this.allYearMonthImagesAlreadyLoaded[k]=contentImage)}contentImage.width>0&&t.drawImage(contentImage,x-this.globalWatch_xCenter,O-this.globalWatch_yCenter,contentImage.width,contentImage.height)}t.globalAlpha=v}if(true!=r&&h.height>0)if(magnify_x_offset=0,magnify_y_offset=0,magnify_x_scale=1,magnify_y_scale=1,true==e&&(magnify_x_offset=this.globalWatch_magnifiedOffsetX,magnify_y_offset=this.globalWatch_magnifiedOffsetY,magnify_x_scale=this.globalWatch_magnifiedValue,magnify_y_scale=this.globalWatch_magnifiedValue),null!==h.maskImage&&void 0!==h.maskImage&&false==e){var P=this.tmpCanvas.getContext("2d");P.canvas.width=this.globalWatch_width,P.canvas.height=this.globalWatch_height,P.clearRect(-this.globalWatch_width,-this.globalWatch_height,2*this.globalWatch_width,2*this.globalWatch_height),P.save(),P.drawImage(h.maskImage,0,0),P.restore(),"drawOverTransparent"==h.maskMode?P.globalCompositeOperation="source-out":P.globalCompositeOperation="source-in",P.translate(this.globalWatch_xCenter,this.globalWatch_yCenter),P.transform(this.globalWatch_baseScaleX*magnify_x_scale,this.globalWatch_baseSkewX,this.globalWatch_baseSkewY,this.globalWatch_baseScaleY*magnify_y_scale,h.xOffset+magnify_x_offset,h.yOffset+magnify_y_offset),P.rotate(this.degreesToRadians(c)),P.translate(-h.xCenter,-h.yCenter),true==this.isGettingDrawSnapShot&&console.log("drawing "+o+'"'+h.imageName+'" masked by "'+h.maskName+'" in "'+h.maskMode+'" mode'),P.drawImage(h.image,0,0,h.width,h.height),t.drawImage(this.tmpCanvas,-this.globalWatch_xCenter,-this.globalWatch_yCenter,this.globalWatch_width,this.globalWatch_height)}else{t.transform(this.globalWatch_baseScaleX*magnify_x_scale,this.globalWatch_baseSkewX,this.globalWatch_baseSkewY,this.globalWatch_baseScaleY*magnify_y_scale,h.xOffset+magnify_x_offset,h.yOffset+magnify_y_offset),t.rotate(this.degreesToRadians(c)),t.translate(-h.xCenter,-h.yCenter),true==this.isGettingDrawSnapShot&&console.log("drawing "+o+'"'+h.imageName+'"'),t.drawImage(h.image,0,0,h.width,h.height);for(var N=0;N<h.effectViews.length;N++)h.effectViews[N].height>0&&(t.globalAlpha=this.getAlphaForRotation(h.effectTypes[N],this.degreesToRadians(c),"normal"),true==this.isGettingDrawSnapShot&&console.log('    with "'+h.effectTypes[N]+'"'),t.drawImage(h.effectViews[N],0,0,h.width,h.height))}}t.restore()}}},this.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo=function(t,a,s){if(true==e.canvasIsAvailable()){if(true==this.shouldTestPerformance&&this.performanceTreshold>this.lastSmallestSuccessfulTreshold&&false==this.isInLowPerfMode&&0==this.performanceLast10.length&&(this.shouldTestPerformance=false),true==this.shouldTestPerformance)var o=performance.now();for(var n in this.timezones){var h,l=this.timezones[n];if(h=t||this.getDateForGivenTimezone(l.timezoneName),true==this.shouldTakeSpinTimeDelayIntoAccount){var r=this.globalWatch_spinTime+this.globalWatch_delayBeforeSpin;h.setSeconds(h.getSeconds()+r/1e3)}l.updateDataWithDate(h)}var c;if(true==this.hasCyclop&&this.globalWatch_cyclopMaskImage.height>0)f(c=document.getElementById("OTW_magnifiedTimepiece_"+i).getContext("2d"),true),this.drawTimepiece(c,true,a,s),c.save(),c.translate(-this.globalWatch_xCenter,-this.globalWatch_yCenter),c.globalCompositeOperation="destination-in",c.drawImage(this.globalWatch_cyclopMaskImage,0,0),c.restore(),c.restore();if(f(c=document.getElementById("OTW_mainTimepiece_"+i).getContext("2d"),true),this.drawTimepiece(c,false,a,s),true==this.hasCyclop&&this.globalWatch_cyclopMaskImage.height>0&&(c.save(),c.translate(-this.globalWatch_xCenter,-this.globalWatch_yCenter),c.globalCompositeOperation="destination-out",c.drawImage(this.globalWatch_cyclopMaskImage,0,0),c.restore()),c.restore(),true==this.watchIsShownOnStaticDefaultTimeAndDate&&this.imagesToBeLoaded.length>0&&(this.globalWatch_timer=setTimeout(function(){e.updateWatchTimeNowToOptionalDate_toOptionalRotations_saveRotationsTo(t,a,s)},1e3/this.globalWatch_ticksPerSecond)),true==this.shouldTestPerformance){for(var d=performance.now();this.performanceLast10.length>=10;)this.performanceLast10.shift();var u=d-o;this.performanceLast10.push(u);for(var m=0,_=0;_<this.performanceLast10.length;_++)m+=this.performanceLast10[_];(m/=this.performanceLast10.length)>this.performanceTreshold?this.isInLowPerfMode=true:(this.isInLowPerfMode=false,this.performanceTreshold<this.lastSmallestSuccessfulTreshold&&(this.lastSmallestSuccessfulTreshold=this.performanceTreshold));var g=new Date;this.performanceSamplingHistory.push("updateWatchTimeNowToOptionalDate moy = "+m+" ms / over "+this.performanceTreshold+" treshold / vs "+this.lastSmallestSuccessfulTreshold+" last best / isInLowPerfMode = "+this.isInLowPerfMode+" / on "+g.toLocaleString()+" and "+g.getMilliseconds()+" ms"),10==this.performanceLast10.length&&(this.shouldTestPerformance=false)}}function f(t,i,a){t.clearRect(-e.globalWatch_width,-e.globalWatch_height,2*e.globalWatch_width,2*e.globalWatch_height),false==i||(t.save(),a||t.translate(e.globalWatch_xCenter,e.globalWatch_yCenter))}},this.moonPhaseForDate=function(t){var e,i=t,a=function(t){var e=i;t&&(e=t);return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,0)}(i),s=r(function(t){for(var e=new Date(t),i=o(e),a=i,s=e,n=true,h=false,r=1;r<960;r++){var c=l(-r,e),d=o(c);if(n=d-a>0,i<d&&n&&(i=d,s=c),a=d,!n&&h)return s;h=n}return s}(a),a);return e=2*Math.PI/29,s*e;function o(t){var e=i.getTime()/1e3;if(t)e=new Date(t).getTime()/1e3;var a,s=e/86400+2440587.5-2444238.5,o=n(n(360/365.2422*s)+278.83354-282.596403),l=function(t,e){var i=t=h(t);for(;Math.abs(a)>1e-6;){var a=i-e*sin(i)-t;i-=a/(1-e*cos(i))}return i}(o,.016718);l=Math.sqrt(1.016718/.983282)*Math.tan(l/2);var r=n((l=2*(Math.atan(l)*(180/Math.PI)))+282.596403),c=(Math.cos(h(l)),n(13.1763966*s+64.975464)),d=n(c-.1114041*s-349.383063),u=(n(151.950429-.0529539*s),1.2739*Math.sin(h(2*(c-r)-d))),m=.1858*Math.sin(h(o)),_=d+u-m-.37*Math.sin(h(o)),g=c+u+6.2886*Math.sin(h(_))-m+.214*Math.sin(h(2*_)),f=g+.6583*Math.sin(h(2*(g-r)))-r;a=(1-Math.cos(h(f)))/2;n(f);return 100*a}function n(t){return t-360*Math.floor(t/360)}function h(t){return t*(Math.PI/180)}function l(t,e){var i=new Date(e),a=i.getTime();return i.setTime(a+36e5*t),i}function r(t,e){return Math.floor((c(e)-c(t))/864e5)}function c(t){var e=new Date(t);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e}},this.changeStateImagesButtonFrom_to=function(t,e){},this.getChronoRawDisplayValue=function(){return true==this.globalWatch_isRunning?this.chronoTotalAccumulatedTime:0},this.getCountdownRawDisplayValue=function(){return this.countdownInitialValue-this.countdownTotalRunTime},this.getTachymeterRawDisplayValue=function(){var t=this.getChronoRawDisplayValue();return t>=.1?3600/t:3600},this.setButtonsInteractivityTo=function(t){for(var e=0;e<this.buttons.length;e++);},this.setCountdownMinutesTo=function(t){t<1&&(t=1),this.countdownInitialValue=60*t,this.countdownTotalRunTime=0},this.setCountdownMinutesToNextRoundValue=function(){var t=this.countdownInitialValue-this.countdownTotalRunTime,e=Math.floor(t/60%60);this.setCountdownMinutesTo(e+1)},this.setCountdownMinutesToPreviousRoundValue=function(){var t=this.countdownInitialValue-this.countdownTotalRunTime,e=floor(t/60%60);0==this.countdownTotalRunTime&&e--,this.setCountdownMinutesTo(e)},this.switchAlarmOnOff=function(){true==this.alarmIsOn?this.alarmIsOn=false:this.alarmIsOn=true},this.resetChronoMovement=function(){this.chronoTotalRunTime=0,this.chronoTotalAccumulatedTime=0},this.startChronoMovement=function(){this.chronoTimestampOnStart=new Date,this.chronoIsRunning=true},this.stopChronoMovement=function(){var t=new Date;chronoInterval=(t.getTime()-this.chronoTimestampOnStart.getTime())/1e3,this.chronoTotalRunTime+=chronoInterval,this.chronoIsRunning=false},this.startCountdownMovement=function(){this.countdownTimestampOnStart=new Date;var t=(new Date).getTime();this.countdownTimestampOnStart.setTime(t-1e3*this.countdownTotalRunTime),this.countdownIsRunning=true,this.countdownShouldAlertWhenFinished=true},this.stopCountdownMovement=function(){this.countdownIsRunning=false},this.resetFlybackMovement=function(){this.resetChronoMovement()},this.startFlybackMovement=function(){this.startChronoMovement()},this.stopFlybackMovement=function(){this.stopChronoMovement()},this.onAlarmButtonPressed=function(t){this.switchAlarmOnOff()},this.onAlarmButtonReleased=function(t){},this.onChronoTopButtonPressed=function(t){true!=this.chronoIsRunning?(this.startChronoMovement(),this.nextButtonReleaseShouldBeTakenIntoAccount=false):this.stopChronoMovement()},this.onChronoTopButtonReleased=function(t){true==this.nextButtonReleaseShouldBeTakenIntoAccount?this.chronoIsRunning:this.nextButtonReleaseShouldBeTakenIntoAccount=true},this.onChronoBottomButtonPressed=function(t){true==this.chronoIsRunning||this.resetChronoMovement()},this.onChronoBottomButtonReleased=function(t){true==this.nextButtonReleaseShouldBeTakenIntoAccount||(this.nextButtonReleaseShouldBeTakenIntoAccount=true)},this.onCountdownTopButtonPressed=function(t){true!=this.countdownIsRunning?(this.startCountdownMovement(),this.nextButtonReleaseShouldBeTakenIntoAccount=false):this.stopCountdownMovement()},this.onCountdownTopButtonReleased=function(t){true==this.nextButtonReleaseShouldBeTakenIntoAccount?this.countdownIsRunning:this.nextButtonReleaseShouldBeTakenIntoAccount=true},this.onCountdownBottomButtonPressed=function(t){this.resetCountdownMovement()},this.onCountdownBottomButtonReleased=function(t){true==this.nextButtonReleaseShouldBeTakenIntoAccount||(this.nextButtonReleaseShouldBeTakenIntoAccount=true)},this.onFlybackTopButtonPressed=function(t){true!=this.chronoIsRunning?(this.startFlybackMovement(),this.nextButtonReleaseShouldBeTakenIntoAccount=false):this.stopFlybackMovement()},this.onFlybackTopButtonReleased=function(t){true==this.nextButtonReleaseShouldBeTakenIntoAccount?this.chronoIsRunning:this.nextButtonReleaseShouldBeTakenIntoAccount=true},this.onFlybackBottomButtonPressed=function(t){true==this.chronoIsRunning&&(this.stopFlybackMovement(),this.flybackShouldRestartAfterReset=true),this.resetFlybackMovement()},this.onFlybackBottomButtonReleased=function(t){true==this.flybackShouldRestartAfterReset&&(this.flybackShouldRestartAfterReset=false,this.startFlybackMovement())},this.onCountdownReachedEnd=function(){this.countdownHasReachedEnd=true,true==this.countdownShouldAlertWhenFinished&&(this.countdownShouldAlertWhenFinished=false)},this.createAdditionalVars=function(){for(this.globalWatch_lightSourceAngle=this.globalWatch_lightSourceAngle;this.globalWatch_lightSourceAngle<0;)this.globalWatch_lightSourceAngle+=360;for(;this.globalWatch_lightSourceAngle>360;)this.globalWatch_lightSourceAngle-=360;for(this.left_shade_start=this.globalWatch_lightSourceAngle+180,this.left_shade_end=this.globalWatch_lightSourceAngle,this.right_shade_start=this.globalWatch_lightSourceAngle,this.right_shade_end=this.globalWatch_lightSourceAngle+180,this.top_shade_start=this.globalWatch_lightSourceAngle+90,this.top_shade_end=this.globalWatch_lightSourceAngle-90,this.bottom_shade_start=this.globalWatch_lightSourceAngle+90,this.bottom_shade_end=this.globalWatch_lightSourceAngle-90;this.left_shade_start>this.left_shade_end;)this.left_shade_end+=360;for(;this.right_shade_start>this.right_shade_end;)this.right_shade_end+=360;for(;this.top_shade_start>this.top_shade_end;)this.top_shade_end+=360;for(;this.bottom_shade_start>this.bottom_shade_end;)this.bottom_shade_end+=360;for(;this.left_shade_end>360;)this.left_shade_start-=360,this.left_shade_end-=360;for(;this.right_shade_end>360;)this.right_shade_start-=360,this.right_shade_end-=360;for(;this.top_shade_end>360;)this.top_shade_start-=360,this.top_shade_end-=360;for(;this.bottom_shade_end>360;)this.bottom_shade_start-=360,this.bottom_shade_end-=360;if(this.left_shade_min=0,this.left_shade_max=100,this.right_shade_min=0,this.right_shade_max=100,this.top_shade_min=0,this.top_shade_max=100,this.bottom_shade_min=0,this.bottom_shade_max=100,this.left_shade_max_point=0,this.left_shade_range=0,this.left_shade_mid_range=0,this.right_shade_max_point=0,this.right_shade_range=0,this.right_shade_mid_range=0,this.top_shade_max_point=0,this.top_shade_range=0,this.top_shade_mid_range=0,this.bottom_shade_max_point=0,this.bottom_shade_range=0,this.bottom_shade_mid_range=0,this.left_shade_start<this.left_shade_end){for(this.left_shade_max_point=(this.left_shade_start+this.left_shade_end)/2;this.left_shade_max_point>360;)this.left_shade_max_point-=360;this.left_shade_range=this.left_shade_end-this.left_shade_start}else{for(this.left_shade_max_point=this.left_shade_start+this.left_shade_end;this.left_shade_max_point>360;)this.left_shade_max_point-=360;this.left_shade_max_point=this.left_shade_max_point/2,this.left_shade_range=360+this.left_shade_end-this.left_shade_start}if(this.left_shade_mid_range=this.left_shade_range/2,this.right_shade_start<this.right_shade_end){for(this.right_shade_max_point=(this.right_shade_start+this.right_shade_end)/2;this.right_shade_max_point>360;)this.right_shade_max_point-=360;this.right_shade_range=this.right_shade_end-this.right_shade_start}else{for(this.right_shade_max_point=this.right_shade_start+this.right_shade_end;this.right_shade_max_point>360;)this.right_shade_max_point-=360;this.right_shade_max_point=this.right_shade_max_point/2,this.right_shade_range=360+this.right_shade_end-this.right_shade_start}if(this.right_shade_mid_range=this.right_shade_range/2,this.top_shade_start<this.top_shade_end){for(this.top_shade_max_point=(this.top_shade_start+this.top_shade_end)/2;this.top_shade_max_point>360;)this.top_shade_max_point-=360;this.top_shade_range=this.top_shade_end-this.top_shade_start}else{for(this.top_shade_max_point=this.top_shade_start+this.top_shade_end;this.top_shade_max_point>360;)this.top_shade_max_point-=360;this.top_shade_max_point=this.top_shade_max_point/2,this.top_shade_range=360+this.top_shade_end-this.top_shade_start}if(this.top_shade_mid_range=this.top_shade_range/2,this.bottom_shade_start<this.bottom_shade_end){for(this.bottom_shade_max_point=(this.bottom_shade_start+this.bottom_shade_end)/2;this.bottom_shade_max_point>360;)this.bottom_shade_max_point-=360;this.bottom_shade_range=this.bottom_shade_end-this.bottom_shade_start}else{for(this.bottom_shade_max_point=this.bottom_shade_start+this.bottom_shade_end;this.bottom_shade_max_point>360;)this.bottom_shade_max_point-=360;this.bottom_shade_max_point=this.bottom_shade_max_point/2,this.bottom_shade_range=360+this.bottom_shade_end-this.bottom_shade_start}this.bottom_shade_mid_range=this.bottom_shade_range/2},this.getAlphaForRotation=function(t,e,i){var a,s,o,n;if(e=180*e/Math.PI-this.globalWatch_baseRotationAngle,subf_find_distance_to_max_point=function(t){var i=Math.abs(t-e);return i>180&&(i=Math.abs(180-(i-180))),i},"top_shade"==t)a=(s="reverse"==i?subf_find_distance_to_max_point(-this.top_shade_max_point):subf_find_distance_to_max_point(this.top_shade_max_point))<=this.top_shade_mid_range?this.top_shade_min+(1-s/this.top_shade_mid_range)*(this.top_shade_max-this.top_shade_min):this.top_shade_min;else if("bottom_shade"==t){var h;a=180-(h="reverse"==i?subf_find_distance_to_max_point(-this.bottom_shade_max_point):subf_find_distance_to_max_point(this.bottom_shade_max_point))<=this.bottom_shade_mid_range?this.bottom_shade_min+(1-(180-h)/this.bottom_shade_mid_range)*(this.bottom_shade_max-this.bottom_shade_min):this.bottom_shade_min}return"reverse"==i?"left_shade"==t?a=(o=subf_find_distance_to_max_point(-this.left_shade_max_point))<=this.left_shade_mid_range?(1-o/void 0)*(this.left_shade_max-this.left_shade_min):this.left_shade_min:"right_shade"==t&&(a=(n=subf_find_distance_to_max_point(-this.right_shade_max_point))<=this.right_shade_mid_range?(1-n/void 0)*(this.right_shade_max-this.right_shade_min):this.right_shade_min):"left_shade"==t?a=(o=subf_find_distance_to_max_point(this.left_shade_max_point))<=this.left_shade_mid_range?this.left_shade_min+(1-o/this.left_shade_mid_range)*(this.left_shade_max-this.left_shade_min):this.left_shade_min:"right_shade"==t&&(a=(n=subf_find_distance_to_max_point(this.right_shade_max_point))<=this.right_shade_mid_range?this.right_shade_min+(1-n/this.right_shade_mid_range)*(this.right_shade_max-this.right_shade_min):this.right_shade_min),a/100},this.canvasIsAvailable=function(){return!!document.getElementById("OTW_mainTimepiece_"+i)},this.degreesToRadians=function(t){return t*=this.globalWatch_timeCoef,(t%=360)*(Math.PI/180)},this.radiansToDegrees=function(t){return t*(180/Math.PI)},this.easeInOutQuadWithT_withB_withC_withD=function(t,e,i,a){if(t<a/2)return 2*i*t*t/(a*a)+e;var s=t-a/2;return-2*i*s*s/(a*a)+2*i*s/a+i/2+e},this.getX_withRotatedCoordinateSystemTo_withY=function(t,e,i){var a=this.degreesToRadians(e);return t*Math.cos(a)+i*Math.sin(a)},this.getY_withRotatedCoordinateSystemTo_withX=function(t,e,i){var a=this.degreesToRadians(e);return-i*Math.sin(a)+t*Math.cos(a)}}function OTWButton(){}function OTWHand(){var t=this;this.createNewHandWithTarget_imageNamed_toCenter_xCenter_yCenter_xOffset_yOffset_cycleType_cycleTime_cycleIsReversed_cycleIsSmooth_timezone_lightEffects_maskName_maskMode_duplicateUnderCyclop_isOptional=function(e,i,a,s,o,n,h,l,r,c,d,u,m,_,g,f,p){var T=i.split(".")[0],b=i.split(".")[1];this.width=0,this.height=0,this.maskImage=null,null!=_&&(this.maskImage=new Image,this.maskImage.src=e.globalWatch_imageFolderName+"/"+_),this.maskMode=g,this.duplicateUnderCyclop=f;var y=new Image;if(y.onload=function(){e.imagesToBeLoaded.splice(e.imagesToBeLoaded.indexOf(y.src),1),t.width=y.width,t.height=y.height,t.image=y},y.src=e.globalWatch_imageFolderName+"/"+i,e.imagesToBeLoaded.push(y.src),e.imageURLs[y.src]=true,this.effectTypes=new Array,this.effectViews=new Array,m)for(var w=0;w<m.length;w++){this.effectTypes.push(m[w]);var W=new Image;W.src=e.globalWatch_imageFolderName+"/"+T+"_"+m[w]+"."+b,this.effectViews.push(W),e.imageURLs[W.src]=true}this.cycleType=l,this.cycleTime=r,this.cycleIsReversed=c,this.cycleIsSmooth=d,this.xCenter=s,this.yCenter=o,this.xOffset=n,this.yOffset=h,this.imageName=i,this.maskName=_,this.isOptional=p,null==u&&(u=""),this.timezone=u}}function OTWTimepieceCenter(){this.createNewTimepieceCenterNamed_xCenter_yCenter=function(t,e,i){this.name=t,this.xCenter=e,this.yCenter=i}}function OTWTimezone(){this.createNewTimeZoneWithName=function(t){this.timezoneName=t,this.millisecond=0,this.second=0,this.minute=0,this.hour=0,this.monthDate=0,this.weekDay=0,this.yearMonth=0,this.year=0},this.getDate=function(){return new Date(this.year,this.yearMonth,this.monthDate,this.hour,this.minute,this.second,this.millisecond)},this.updateDataWithDate=function(t){this.millisecond=t.getMilliseconds(),this.second=t.getSeconds(),this.minute=t.getMinutes(),this.hour=t.getHours(),this.monthDate=t.getDate(),this.weekDay=t.getDay(),this.yearMonth=t.getMonth(),this.year=t.getFullYear()}}